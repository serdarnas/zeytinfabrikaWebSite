<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ürün Detayı (Varyantlı): [Ürün Adı] - Yönetim Paneli</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Özel Stiller -->
    <style>
        body {
            background-color: #f8f9fa;
            font-family: sans-serif;
        }
        .sidebar {
            position: fixed; top: 0; bottom: 0; left: 0; z-index: 100;
            padding: 48px 0 0; box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);
            background-color: #343a40;
        }
        .sidebar-sticky { position: relative; top: 0; height: calc(100vh - 48px); padding-top: .5rem; overflow-x: hidden; overflow-y: auto; }
        .nav-link { color: #adb5bd; transition: color .15s ease-in-out, background-color .15s ease-in-out; font-weight: 500; }
        .nav-link:hover, .nav-link.active { color: #fff; background-color: #495057; }
        .nav-link .bi { margin-right: 8px; font-size: 1.1rem; vertical-align: text-bottom; }
        .navbar-brand { padding-top: .75rem; padding-bottom: .75rem; font-size: 1.2rem; background-color: rgba(0, 0, 0, .25); box-shadow: inset -1px 0 0 rgba(0, 0, 0, .25); color: #fff; }
        .navbar .navbar-toggler { top: .25rem; right: 1rem; }

        .page-header {
            background-color: #007bff; /* Mavi tonu */
            color: white;
            padding: 1.25rem 1.5rem;
            margin-bottom: 1.5rem;
            border-radius: 0.375rem;
        }
        .page-header h1 { margin-bottom: 0.25rem; font-size: 1.75rem; }
        .page-header .text-muted { color: rgba(255,255,255,0.8) !important; }

        .card { border-radius: 0.5rem; box-shadow: 0 2px 5px rgba(0,0,0,0.08); border:none; }
        .card-header { background-color: #e9ecef; font-weight: 600; padding: 1rem 1.25rem; }
        .card-header i { margin-right: 8px; color: #007bff; }
        .card-body { padding: 1.5rem; }
        .form-label { font-weight: 500; }

        .variant-table th {
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            color: #495057;
        }
        .variant-table td {
            font-size: 0.9rem;
            vertical-align: middle;
        }
        .variant-actions .btn {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
        }
        .badge.bg-success { background-color: #198754 !important; }
        .badge.bg-warning { background-color: #ffc107 !important; color: #000 !important;}
        .badge.bg-danger { background-color: #dc3545 !important; }
    </style>
</head>
<body>

    <!-- Üst Navbar -->
    <nav class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
        <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3" href="#">
             <i class="bi bi-tree-fill me-2"></i> Zeytin Dalı Fabrikası
        </a>
        <button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <input class="form-control form-control-dark w-100" type="text" placeholder="Ara..." aria-label="Ara">
        <div class="navbar-nav"> <div class="nav-item text-nowrap"> <a class="nav-link px-3" href="#"><i class="bi bi-box-arrow-right"></i> Çıkış Yap</a></div></div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar Menü -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3 sidebar-sticky">
                    <ul class="nav flex-column">
                        <li class="nav-item"> <a class="nav-link" href="#"><i class="bi bi-house-door-fill"></i> Ana Panel</a></li>
                        <li class="nav-item"> <a class="nav-link active" aria-current="page" href="#"><i class="bi bi-tags-fill"></i> Ürünler</a></li> <!-- Ürünler aktif -->
                        <!-- Diğer menü öğeleri -->
                    </ul>
                </div>
            </nav>

            <!-- Ana İçerik Alanı -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- Ürün Başlığı ve Genel Bilgiler -->
                <div class="page-header">
                    <nav aria-label="breadcrumb" class="mb-1">
                      <ol class="breadcrumb breadcrumb-transparent small p-0 m-0">
                        <li class="breadcrumb-item"><a href="#" class="text-white-50">Ürün Listesi</a></li>
                        <li class="breadcrumb-item active text-white" aria-current="page">Ürün Detayı</li>
                      </ol>
                    </nav>
                    <h1>Natürel Sızma Zeytinyağı - Erken Hasat</h1>
                    <p class="text-muted mb-0">Kategori: Zeytinyağları | Marka: Zeytin Dalı Premium</p>
                </div>

                <!-- Ana Ürün Aksiyonları -->
                <div class="mb-4">
                    <button class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#editProductModal"><i class="bi bi-pencil-square me-1"></i> Ana Ürünü Düzenle</button>
                    <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addVariantModal"><i class="bi bi-plus-circle-fill me-1"></i> Yeni Varyant Ekle</button>
                     <button class="btn btn-outline-secondary ms-2"><i class="bi bi-images me-1"></i> Ürün Görselleri</button>
                </div>

                <!-- Varyantlar Bölümü -->
                <div class="card">
                    <div class="card-header">
                        <i class="bi bi-diagram-2-fill"></i> Ürün Varyantları ve Stok Durumu
                    </div>
                    <div class="card-body p-0"> <!-- Tablo için padding'i kaldıralım -->
                        <div class="table-responsive">
                            <table class="table table-hover variant-table mb-0">
                                <thead>
                                    <tr>
                                        <th>Varyant Adı</th>
                                        <th>SKU</th>
                                        <th>Barkod</th>
                                        <th>Alış Fiyatı (₺)</th>
                                        <th>Satış Fiyatı (₺)</th>
                                        <th>Stok Adedi</th>
                                        <th>Durum</th>
                                        <th>İşlemler</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Örnek Varyantlar (Backend'den gelecek) -->
                                    <tr>
                                        <td><strong>250ml Cam Şişe</strong></td>
                                        <td>NSZ-EH-250CS</td>
                                        <td>869000111222</td>
                                        <td>75.00</td>
                                        <td>150.00</td>
                                        <td><span class="fw-bold">120</span></td>
                                        <td><span class="badge bg-success">Aktif</span></td>
                                        <td class="variant-actions">
                                            <button class="btn btn-outline-primary" title="Düzenle" data-bs-toggle="modal" data-bs-target="#editVariantModal" data-variant-id="1"><i class="bi bi-pencil-fill"></i></button>
                                            <button class="btn btn-outline-info" title="Stok Hareketi"><i class="bi bi-arrow-left-right"></i></button>
                                            <button class="btn btn-outline-danger" title="Sil"><i class="bi bi-trash-fill"></i></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>500ml Cam Şişe</strong></td>
                                        <td>NSZ-EH-500CS</td>
                                        <td>869000111333</td>
                                        <td>120.00</td>
                                        <td>250.00</td>
                                        <td><span class="fw-bold text-danger">8</span></td>
                                        <td><span class="badge bg-warning">Düşük Stok</span></td>
                                         <td class="variant-actions">
                                            <button class="btn btn-outline-primary" title="Düzenle" data-bs-toggle="modal" data-bs-target="#editVariantModal" data-variant-id="2"><i class="bi bi-pencil-fill"></i></button>
                                            <button class="btn btn-outline-info" title="Stok Hareketi"><i class="bi bi-arrow-left-right"></i></button>
                                            <button class="btn btn-outline-danger" title="Sil"><i class="bi bi-trash-fill"></i></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>1L Teneke Kutu</strong></td>
                                        <td>NSZ-EH-1LTN</td>
                                        <td>869000111444</td>
                                        <td>200.00</td>
                                        <td>420.00</td>
                                        <td><span class="fw-bold">75</span></td>
                                        <td><span class="badge bg-success">Aktif</span></td>
                                         <td class="variant-actions">
                                            <button class="btn btn-outline-primary" title="Düzenle" data-bs-toggle="modal" data-bs-target="#editVariantModal" data-variant-id="3"><i class="bi bi-pencil-fill"></i></button>
                                            <button class="btn btn-outline-info" title="Stok Hareketi"><i class="bi bi-arrow-left-right"></i></button>
                                            <button class="btn btn-outline-danger" title="Sil"><i class="bi bi-trash-fill"></i></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>5L Teneke Kutu</strong></td>
                                        <td>NSZ-EH-5LTN</td>
                                        <td>869000111555</td>
                                        <td>900.00</td>
                                        <td>1850.00</td>
                                        <td><span class="fw-bold">0</span></td>
                                        <td><span class="badge bg-danger">Stokta Yok</span></td>
                                         <td class="variant-actions">
                                            <button class="btn btn-outline-primary" title="Düzenle" data-bs-toggle="modal" data-bs-target="#editVariantModal" data-variant-id="4"><i class="bi bi-pencil-fill"></i></button>
                                            <button class="btn btn-outline-info" title="Stok Hareketi"><i class="bi bi-arrow-left-right"></i></button>
                                            <button class="btn btn-outline-danger" title="Sil"><i class="bi bi-trash-fill"></i></button>
                                        </td>
                                    </tr>
                                    <!-- Diğer Varyantlar -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Genel Satış/Alış Geçmişi (Opsiyonel, bir önceki tasarımdan uyarlanabilir) -->
                <div class="row g-4 mt-2">
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header"><i class="bi bi-graph-up"></i> Son Satış Hareketleri (Tüm Varyantlar)</div>
                            <div class="card-body">
                                <p class="text-muted">Buraya tüm varyantların toplam satış hareketleri veya bir grafik gelebilir.</p>
                            </div>
                        </div>
                    </div>
                     <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header"><i class="bi bi-graph-down"></i> Son Alış/Üretim Hareketleri (Tüm Varyantlar)</div>
                            <div class="card-body">
                                 <p class="text-muted">Buraya tüm varyantların toplam alış/üretim maliyet hareketleri veya bir grafik gelebilir.</p>
                            </div>
                        </div>
                    </div>
                </div>
                 <div style="height: 50px;"></div> <!-- Sayfa sonuna biraz boşluk -->
            </main>
        </div>
    </div>

    <!-- Yeni/Düzenle Varyant Modalı -->
    <div class="modal fade" id="addVariantModal" tabindex="-1" aria-labelledby="variantModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="variantModalLabel"><i class="bi bi-plus-square-dotted"></i> Yeni Varyant Ekle</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <form id="variantForm" class="needs-validation" novalidate>
              <div class="modal-body">
                  <input type="hidden" id="variantId"> <!-- Düzenleme için -->
                  <div class="row g-3">
                      <div class="col-md-12">
                          <label for="variantName" class="form-label">Varyant Adı / Özelliği</label>
                          <input type="text" class="form-control" id="variantName" placeholder="Örn: 500ml Cam Şişe, 1L Teneke (Siyah Etiket)" required>
                          <div class="invalid-feedback">Lütfen varyant adını girin.</div>
                      </div>
                      <div class="col-md-6">
                          <label for="variantSku" class="form-label">Stok Kodu (SKU)</label>
                          <input type="text" class="form-control" id="variantSku" required>
                           <div class="invalid-feedback">Lütfen SKU girin.</div>
                      </div>
                      <div class="col-md-6">
                          <label for="variantBarcode" class="form-label">Barkod (EAN/UPC)</label>
                          <input type="text" class="form-control" id="variantBarcode">
                      </div>
                       <div class="col-md-4">
                          <label for="variantAlisFiyati" class="form-label">Alış Fiyatı (₺)</label>
                          <input type="number" step="0.01" class="form-control" id="variantAlisFiyati">
                      </div>
                       <div class="col-md-4">
                          <label for="variantSatisFiyati" class="form-label">Satış Fiyatı (₺)</label>
                          <input type="number" step="0.01" class="form-control" id="variantSatisFiyati" required>
                          <div class="invalid-feedback">Lütfen satış fiyatını girin.</div>
                      </div>
                       <div class="col-md-4">
                          <label for="variantStok" class="form-label">Mevcut Stok Adedi</label>
                          <input type="number" class="form-control" id="variantStok" value="0" required min="0">
                           <div class="invalid-feedback">Lütfen stok adedini girin.</div>
                      </div>
                      <div class="col-md-6">
                        <label for="variantDurum" class="form-label">Durum</label>
                        <select class="form-select" id="variantDurum" required>
                            <option value="aktif" selected>Aktif</option>
                            <option value="pasif">Pasif (Satışa Kapalı)</option>
                            <option value="stok_yok">Stokta Yok (Otomatik)</option>
                        </select>
                      </div>
                      <div class="col-md-6">
                          <label for="variantAgirlik" class="form-label">Ağırlık (gr/ml) (Opsiyonel)</label>
                          <input type="number" step="0.1" class="form-control" id="variantAgirlik" placeholder="Kargo hesaplaması için">
                      </div>
                      <!-- Diğer varyant özellikleri eklenebilir: Renk, Boyut, Malzeme vb. -->
                  </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">İptal</button>
                <button type="submit" class="btn btn-primary"><i class="bi bi-save-fill me-1"></i> Varyantı Kaydet</button>
              </div>
          </form>
        </div>
      </div>
    </div>
    <!-- Ana Ürün Düzenleme Modalı (Benzer yapıda, ana ürün bilgilerini içerir) -->


    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script>
        // Bootstrap Form Doğrulama JS
        (() => {
          'use strict'; const forms = document.querySelectorAll('.needs-validation');
          Array.from(forms).forEach(form => {
            form.addEventListener('submit', event => {
              if (!form.checkValidity()) { event.preventDefault(); event.stopPropagation(); }
              form.classList.add('was-validated');
            }, false);
          });
        })();

        // Varyant Ekle/Düzenle Modalı Yönetimi
        const addVariantModal = document.getElementById('addVariantModal');
        const variantForm = document.getElementById('variantForm');
        const variantModalLabel = document.getElementById('variantModalLabel');
        const variantIdInput = document.getElementById('variantId');

        // Bu, düzenleme butonlarından da çağrılacak. Şimdilik sadece yeni ekleme için.
        if (addVariantModal) {
            addVariantModal.addEventListener('show.bs.modal', event => {
                const button = event.relatedTarget;
                const mode = button.id === 'editVariantTrigger' ? 'edit' : 'add'; // Gerçek butona göre ayarlanmalı

                if (mode === 'edit') {
                    variantModalLabel.innerHTML = '<i class="bi bi-pencil-square"></i> Varyantı Düzenle';
                    const variantId = button.dataset.variantId; // Düzenlenecek varyantın ID'si
                    variantIdInput.value = variantId;
                    // TODO: Backend'den variantId'ye göre verileri çekip formu doldur
                    // Örnek: document.getElementById('variantName').value = fetchedData.name;
                    console.log("Düzenleme modu, ID:", variantId);
                } else {
                    variantModalLabel.innerHTML = '<i class="bi bi-plus-square-dotted"></i> Yeni Varyant Ekle';
                    variantForm.reset(); // Formu temizle
                    variantIdInput.value = ''; // ID'yi temizle
                }
                variantForm.classList.remove('was-validated');
            });
        }
        if (variantForm) {
            variantForm.addEventListener('submit', function(event) {
                 if (this.checkValidity()) {
                    event.preventDefault();
                    const formData = new FormData(this);
                    const data = { id: variantIdInput.value || null }; // ID varsa düzenleme
                    formData.forEach((value, key) => data[key] = value);

                    console.log("Gönderilecek Varyant Verisi:", data);
                    alert(`Varyant başarıyla ${data.id ? 'güncellendi' : 'eklendi'}! (Simülasyon)`);
                    bootstrap.Modal.getInstance(addVariantModal).hide();
                    // Varyant tablosunu yenileme fonksiyonu çağrılabilir
                 }
            });
        }

        // Örnek olarak düzenleme butonlarına event listener atayalım (gerçekte dinamik olarak yapılmalı)
        // Bu sadece #editVariantModal ID'li tek bir modal için çalışır. Daha iyi bir çözüm,
        // `data-bs-target` ile aynı modalı kullanıp, `show.bs.modal` içinde hangi butondan gelindiğini anlamaktır.
        // Şu anki kod `addVariantModal`'ı hem ekleme hem düzenleme için kullanıyor.
        document.querySelectorAll('button[data-bs-target="#editVariantModal"]').forEach(button => {
            button.addEventListener('click', () => {
                // addVariantModal'daki show.bs.modal listener'ı tetiklenecek ve
                // button.dataset.variantId ile ID'yi alacak.
                // Modal başlığını ve form verilerini doldurma işlemini oraya taşıdık.
                // Bu butona özel bir ID verip (`id="editVariantTrigger"`)
                // show.bs.modal içinde kontrol edebiliriz.
                // Şimdilik manuel olarak label'ı değiştirebiliriz (ama ideal değil)
                 if(variantModalLabel) variantModalLabel.innerHTML = '<i class="bi bi-pencil-square"></i> Varyantı Düzenle';
            });
        });


    </script>
</body>
</html>