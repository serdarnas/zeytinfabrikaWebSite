<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yeni Zeytin Kabul Kaydı - Yönetim Paneli</title>
    <!-- Google Fonts (Poppins) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Özel Stiller (İlk tasarıma uygun) -->
    <style>
        :root {
            --brand-primary-green: #1E4620; --brand-light-green: #4A7856; --brand-gold: #D4AF37;
            --brand-text-light: #FFFFFF; --brand-text-dark: #212529; --brand-text-muted: #6c757d;
            --brand-bg-light: #f9fbf8; --brand-border-color: #dee2e6;
        }
        body { font-family: 'Poppins', sans-serif; background-color: var(--brand-bg-light); color: var(--brand-text-dark); font-size: 0.95rem; }
        .sidebar { position: fixed; top: 0; bottom: 0; left: 0; z-index: 100; padding: 56px 0 0; background-color: var(--brand-primary-green); box-shadow: inset -2px 0 5px rgba(0, 0, 0, 0.1); }
        .sidebar-sticky { position: relative; top: 0; height: calc(100vh - 56px); padding-top: 1rem; overflow-x: hidden; overflow-y: auto; }
        .sidebar .nav-link { color: rgba(255, 255, 255, 0.75); font-weight: 400; padding: 0.75rem 1rem; border-left: 3px solid transparent; transition: all .15s ease; }
        .sidebar .nav-link .bi { color: var(--brand-gold); opacity: 0.9; margin-right: 12px; font-size: 1rem; vertical-align: middle; margin-top: -3px; width: 20px; text-align: center; }
        .sidebar .nav-link:hover { background-color: var(--brand-light-green); color: var(--brand-text-light); border-left-color: var(--brand-gold); }
        .sidebar .nav-link.active { background-color: var(--brand-light-green); color: var(--brand-text-light); font-weight: 600; border-left-color: var(--brand-gold); }
        .sidebar .nav-link.active .bi { color: var(--brand-text-light); opacity: 1; }
        .sidebar-heading { color: rgba(255, 255, 255, 0.5); font-size: 0.8rem; text-transform: uppercase; letter-spacing: 0.5px; padding: 0.5rem 1rem; }
        .navbar.sticky-top { background-color: var(--brand-text-light); box-shadow: 0 .125rem .25rem rgba(0,0,0,.05) !important; padding-top: 0.3rem; padding-bottom: 0.3rem; z-index: 1020; }
        .navbar-brand { background-color: transparent; box-shadow: none; color: var(--brand-primary-green) !important; font-weight: 700; font-size: 1.3rem; padding-left: 1.5rem !important; }
        .navbar-brand .bi { color: var(--brand-gold); margin-right: 5px; font-size: 1.4rem; vertical-align: middle; }
        .navbar-toggler { border: none; }
        .navbar-toggler-icon { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(30, 70, 32, 0.7)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e"); }
        main { padding: 1.5rem; }
        .card { border: none; border-radius: 0.6rem; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06); margin-bottom: 1.5rem; }
        .card-header { background-color: transparent; border-bottom: 1px solid #eee; color: var(--brand-light-green); font-weight: 600; padding: 1rem 1.5rem; /* Biraz daha fazla padding */ }
        .card-header i { color: var(--brand-gold); margin-right: 10px; font-size: 1.2rem; /* Başlık ikonu biraz daha büyük */ }
        .card-body { padding: 2rem; /* Form için daha ferah */ }
        .form-label { font-weight: 500; color: var(--brand-text-dark); }
        .btn-success { background-color: var(--brand-light-green); border-color: var(--brand-light-green); }
        .btn-success:hover { background-color: var(--brand-primary-green); border-color: var(--brand-primary-green); }
    </style>
</head>
<body>

    <!-- Üst Navbar -->
    <nav class="navbar navbar-light sticky-top bg-light flex-md-nowrap p-0 shadow">
        <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3" href="#">
             <i class="bi bi-diagram-3-fill"></i> Zeytin & Yağ A.Ş.
        </a>
        <button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
         <div class="w-100 px-3 d-flex justify-content-end align-items-center">
             <!-- Sağ navbar içeriği (Profil vb.) -->
         </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar Menü -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3 sidebar-sticky">
                    <ul class="nav flex-column">
                        <li class="nav-item"> <a class="nav-link" href="#"><i class="bi bi-pie-chart-fill"></i> Ana Panel</a></li>
                        <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-uppercase">İş Akışı</h6>
                        <li class="nav-item"> <a class="nav-link active" aria-current="page" href="#"><i class="bi bi-box-arrow-in-down"></i> Zeytin Kabul</a></li> <!-- Aktif -->
                        <li class="nav-item"> <a class="nav-link" href="#"><i class="bi bi-arrow-repeat"></i> Üretim Takibi</a></li>
                        <!-- Diğer menü öğeleri -->
                    </ul>
                    <!-- Diğer menü grupları -->
                </div>
            </nav>

            <!-- Ana İçerik Alanı -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- Sayfa Başlığı ve Breadcrumb -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <div>
                        <nav aria-label="breadcrumb">
                          <ol class="breadcrumb small bg-transparent p-0 m-0">
                            <li class="breadcrumb-item"><a href="#">Zeytin Kabul İşlemleri</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Yeni Kayıt Ekle</li>
                          </ol>
                        </nav>
                        <h1 class="h2"><i class="bi bi-basket-fill text-success"></i> Yeni Zeytin Kabul Kaydı</h1>
                    </div>
                </div>

                <!-- Yeni Kayıt Formu -->
                <div class="card">
                    <div class="card-header">
                        <i class="bi bi-pencil-square"></i> Zeytin Giriş Bilgileri
                    </div>
                    <div class="card-body">
                        <form id="yeniZeytinKabulForm" class="row g-3 needs-validation" novalidate>
                            <div class="col-md-4">
                                <label for="partiNo" class="form-label">Parti No / Referans</label>
                                <input type="text" class="form-control" id="partiNo" placeholder="Örn: P2023-109" required>
                                <div class="invalid-feedback">Lütfen parti numarasını girin.</div>
                            </div>
                            <div class="col-md-4">
                                <label for="müstahsilId" class="form-label">Müstahsil (Üretici)</label>
                                <select class="form-select" id="müstahsilId" required>
                                    <option selected disabled value="">Müstahsil Seçiniz...</option>
                                    <option value="1">Mehmet Çiftçi (TC: 11122233344)</option>
                                    <option value="2">Ayşe Tarım (Vergi No: 9876543210)</option>
                                    <option value="3">Bereket Köy Kooperatifi</option>
                                    <!-- Bu liste backend'den doldurulmalı -->
                                </select>
                                <div class="invalid-feedback">Lütfen müstahsili seçin.</div>
                            </div>
                            <div class="col-md-4">
                                <label for="gelisTarihi" class="form-label">Geliş Tarihi ve Saati</label>
                                <input type="datetime-local" class="form-control" id="gelisTarihi" required>
                                <div class="invalid-feedback">Lütfen geliş tarih ve saatini seçin.</div>
                            </div>

                            <div class="col-md-3">
                                <label for="zeytinTuru" class="form-label">Zeytin Türü</label>
                                <select class="form-select" id="zeytinTuru" required>
                                    <option selected disabled value="">Seçiniz...</option>
                                    <option value="Gemlik">Gemlik</option>
                                    <option value="Ayvalık">Ayvalık</option>
                                    <option value="Memecik">Memecik</option>
                                    <option value="Edremit">Edremit</option>
                                    <option value="Domat">Domat</option>
                                    <option value="Trilye">Trilye</option>
                                    <option value="Diğer">Diğer</option>
                                </select>
                                <div class="invalid-feedback">Lütfen zeytin türünü seçin.</div>
                            </div>
                            <div class="col-md-3">
                                <label for="miktarBrut" class="form-label">Brüt Miktar (Kg)</label>
                                <div class="input-group">
                                     <input type="number" step="0.1" class="form-control" id="miktarBrut" placeholder="Kantar Okuması" required min="1">
                                     <span class="input-group-text">Kg</span>
                                     <div class="invalid-feedback">Lütfen brüt miktarı girin.</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <label for="fireOrani" class="form-label">Fire Oranı (%) (Opsiyonel)</label>
                                <div class="input-group">
                                     <input type="number" step="0.1" class="form-control" id="fireOrani" placeholder="Yaprak, dal vb.">
                                     <span class="input-group-text">%</span>
                                </div>
                            </div>
                             <div class="col-md-3">
                                <label for="miktarNet" class="form-label">Net Miktar (Kg)</label>
                                <div class="input-group">
                                     <input type="number" step="0.1" class="form-control" id="miktarNet" readonly required> <!-- Otomatik hesaplanabilir -->
                                     <span class="input-group-text">Kg</span>
                                     <div class="invalid-feedback">Net miktar hesaplanamadı.</div>
                                </div>
                            </div>

                             <div class="col-md-4">
                                <label for="aracPlaka" class="form-label">Araç Plakası (Opsiyonel)</label>
                                <input type="text" class="form-control" id="aracPlaka" placeholder="Örn: 16 ABC 123">
                            </div>
                             <div class="col-md-4">
                                <label for="kasaTipiAdet" class="form-label">Kasa Tipi ve Adedi (Opsiyonel)</label>
                                <input type="text" class="form-control" id="kasaTipiAdet" placeholder="Örn: Plastik Kasa x 50">
                            </div>
                             <div class="col-md-4">
                                <label for="teslimAlan" class="form-label">Teslim Alan Personel</label>
                                <input type="text" class="form-control" id="teslimAlan" required>
                                <div class="invalid-feedback">Teslim alan personel bilgisini girin.</div>
                            </div>

                            <div class="col-12 mt-4">
                                <h5 class="text-muted">İlk Kalite Değerlendirmesi (Gözlem)</h5>
                                <hr class="my-2">
                            </div>

                            <div class="col-md-3">
                                <label for="yabanciMadde" class="form-label">Yabancı Madde Oranı</label>
                                <select class="form-select" id="yabanciMadde">
                                    <option selected value="dusuk">Düşük (&lt; %2)</option>
                                    <option value="orta">Orta (%2 - %5)</option>
                                    <option value="yuksek">Yüksek (&gt; %5)</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="eziklikDurumu" class="form-label">Eziklik / Hasar Durumu</label>
                                 <select class="form-select" id="eziklikDurumu">
                                    <option selected value="az">Az / Yok</option>
                                    <option value="orta">Orta Derecede</option>
                                    <option value="cok">Çok Fazla</option>
                                </select>
                            </div>
                             <div class="col-md-3">
                                <label for="hastalikZararli" class="form-label">Hastalık / Zararlı İzleri</label>
                                 <select class="form-select" id="hastalikZararli">
                                    <option selected value="yok">Görülmedi</option>
                                    <option value="az">Az Miktarda</option>
                                    <option value="belirgin">Belirgin</option>
                                </select>
                            </div>
                             <div class="col-md-3">
                                <label for="genelGörünüm" class="form-label">Genel Görünüm/Olgunluk</label>
                                <select class="form-select" id="genelGörünüm">
                                    <option selected value="cok_iyi">Çok İyi (Homojen, Parlak)</option>
                                    <option value="iyi">İyi</option>
                                    <option value="orta">Orta</option>
                                    <option value="zayif">Zayıf (Karışık, Mat)</option>
                                </select>
                            </div>

                             <div class="col-12">
                                <label for="kabulNotlari" class="form-label">Kabul Notları (Opsiyonel)</label>
                                <textarea class="form-control" id="kabulNotlari" rows="3" placeholder="Özel durumlar, müstahsil talepleri vb."></textarea>
                            </div>

                            <div class="col-12 text-end mt-4">
                                <a href="#" class="btn btn-outline-secondary me-2">İptal Et / Geri Dön</a>
                                <button class="btn btn-success btn-lg" type="submit"><i class="bi bi-save2-fill me-2"></i> Kaydı Tamamla</button>
                            </div>
                        </form>
                    </div>
                </div>

            </main>
        </div>
    </div>

    <!-- Gerekli Scriptler -->
    <script>
        // Bootstrap Form Doğrulama JS
        (() => {
          'use strict'; const forms = document.querySelectorAll('.needs-validation');
          Array.from(forms).forEach(form => {
            form.addEventListener('submit', event => {
              if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
              }
              form.classList.add('was-validated');
            }, false);
          });
        })();

        // Net Miktar Hesaplama (Basit Örnek)
        const miktarBrutInput = document.getElementById('miktarBrut');
        const fireOraniInput = document.getElementById('fireOrani');
        const miktarNetInput = document.getElementById('miktarNet');

        function calculateNetMiktar() {
            const brut = parseFloat(miktarBrutInput.value);
            const fire = parseFloat(fireOraniInput.value);

            if (!isNaN(brut)) {
                if (!isNaN(fire) && fire >= 0 && fire < 100) {
                    const net = brut * (1 - (fire / 100));
                    miktarNetInput.value = net.toFixed(2); // İki ondalık basamak
                } else {
                     miktarNetInput.value = brut.toFixed(2); // Fire yoksa brüt = net
                }
            } else {
                miktarNetInput.value = '';
            }
        }

        if (miktarBrutInput && fireOraniInput && miktarNetInput) {
            miktarBrutInput.addEventListener('input', calculateNetMiktar);
            fireOraniInput.addEventListener('input', calculateNetMiktar);
        }

        // Form Gönderimi (Simülasyon)
        const yeniZeytinKabulForm = document.getElementById('yeniZeytinKabulForm');
        if (yeniZeytinKabulForm) {
            yeniZeytinKabulForm.addEventListener('submit', function(event) {
                // event.preventDefault(); // Gerçek gönderim için bu satır kaldırılmalı veya yorumlanmalı
                // event.stopPropagation(); // ve Bootstrap doğrulamasının submit'i durdurması beklenmeli.

                if (this.checkValidity()) {
                    // Form geçerliyse
                    event.preventDefault(); // Simülasyon için normal submit'i burada da durduralım
                    const formData = new FormData(this);
                    const data = {};
                    formData.forEach((value, key) => data[key] = value);

                    console.log("Gönderilecek Zeytin Kabul Verisi:", data);
                    alert("Yeni zeytin kabul kaydı başarıyla oluşturuldu! (Simülasyon)\nVeriler konsola yazdırıldı.");

                    // Başarılı kayıt sonrası formu temizle veya başka bir sayfaya yönlendir
                    // this.reset();
                    // this.classList.remove('was-validated');
                    // window.location.href = 'zeytin-kabul-listesi.html'; // Örneğin
                }
            });
        }

        // Sayfa yüklendiğinde varsayılan tarih ve saati ayarla
        document.addEventListener('DOMContentLoaded', (event) => {
            const gelisTarihiInput = document.getElementById('gelisTarihi');
            if (gelisTarihiInput) {
                const now = new Date();
                now.setMinutes(now.getMinutes() - now.getTimezoneOffset()); // Yerel saate göre ayarla
                gelisTarihiInput.value = now.toISOString().slice(0,16); // YYYY-MM-DDTHH:mm formatı
            }
        });

    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

</body>
</html>